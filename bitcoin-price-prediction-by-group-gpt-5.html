<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="MFIN7036 Students 2024" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Group GPT-5, Progress Report, " />

<meta property="og:title" content="Bitcoin Price Prediction (by Group &#34;GPT-5&#34;) "/>
<meta property="og:url" content="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/bitcoin-price-prediction-by-group-gpt-5.html" />
<meta property="og:description" content="Introduction Our project aims to explore the relationship between cryptocurrency market dynamics and construct an effective model for predicting Bitcoin prices by analyzing public opinion information. The following are the concrete steps of our project: Data Collection We collected price data from Yahoo Finance and text data from different websites …" />
<meta property="og:site_name" content="MFIN7036 Student Blog 2024" />
<meta property="og:article:author" content="MFIN7036 Students 2024" />
<meta property="og:article:published_time" content="2024-03-18T01:12:00+08:00" />
<meta name="twitter:title" content="Bitcoin Price Prediction (by Group &#34;GPT-5&#34;) ">
<meta name="twitter:description" content="Introduction Our project aims to explore the relationship between cryptocurrency market dynamics and construct an effective model for predicting Bitcoin prices by analyzing public opinion information. The following are the concrete steps of our project: Data Collection We collected price data from Yahoo Finance and text data from different websites …">

        <title>Bitcoin Price Prediction (by Group &#34;GPT-5&#34;)  · MFIN7036 Student Blog 2024
</title>
        <link href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="MFIN7036 Student Blog 2024 - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/"><span class=site-name>MFIN7036 Student Blog 2024</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://buehlmaier.github.io/MFIN7036-student-blog-2024-02
                                    >Home</a>
                                </li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/categories.html">Categories</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/tags.html">Tags</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/bitcoin-price-prediction-by-group-gpt-5.html">
                Bitcoin Price Prediction (by Group "GPT-5")
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <h1>Introduction</h1>
<p>Our project aims to explore the relationship between cryptocurrency market dynamics and construct an effective model for predicting Bitcoin prices by analyzing public opinion information. The following are the concrete steps of our project:</p>
<p><img src="https://s2.loli.net/2024/03/19/bRyaWvc1TAzIJil.png" alt="bitcointalk.png" width="300" ></p>
<h1>Data Collection</h1>
<p>We collected price data from Yahoo Finance and text data from different websites, including Bitcoin Talk, Yahoo Finance and Reddit. The detailed process of crawling has been shown in blog1.</p>
<h1>Data Processing</h1>
<h2>Bitcoin Price</h2>
<p>Instead of using the bitcoin price directly, we used the rise and fall of the price as a dummy variable. It is more practical to predict the price trend than to predict the specific price directly. Price trends are more actionable for traders as they can be used to develop buy or sell strategies.</p>
<blockquote>
<p>Price change = 1 while price rises</p>
<p>Price change = 0 while price falls</p>
</blockquote>
<h2>Sentiment Score</h2>
<p>For the sentences we crawled from the websites, we gave each a sentiment score using TextBlob() and and averaged the scores for each day. The code is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;polarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">polarity</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;subjectivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">subjectivity</span><span class="p">)</span>
</code></pre></div>

<h1>Topic Modeling</h1>
<p>We wanted to confirm if the core topic of the data is closely related to the Bitcoin price we want to predict, but the amount of data is
 too large to analysis. So we used the Topic Modeling method. The code of Topic Modeling is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cv</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">corpus_cv</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="n">corpus_cv</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">feats</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">corpus_array</span> <span class="o">=</span> <span class="n">corpus_cv</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corpus_array</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">feats</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">sources</span><span class="p">)</span>

<span class="c1"># tfidf</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">corpus_tfidf</span> <span class="o">=</span> <span class="n">tfidf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="n">feats_tfidf</span> <span class="o">=</span> <span class="n">tfidf</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">corpus_array_tfidf</span> <span class="o">=</span> <span class="n">corpus_tfidf</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">df_tfidf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corpus_array_tfidf</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">feats_tfidf</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">sources</span><span class="p">)</span>

<span class="n">lda1</span> <span class="o">=</span> <span class="n">LatentDirichletAllocation</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">learning_method</span> <span class="o">=</span> <span class="s1">&#39;online&#39;</span><span class="p">,</span> <span class="n">learning_offset</span> <span class="o">=</span> <span class="mf">50.</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">lda1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus_cv</span><span class="p">)</span>
<span class="n">lda2</span> <span class="o">=</span> <span class="n">LatentDirichletAllocation</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">learning_method</span> <span class="o">=</span> <span class="s1">&#39;online&#39;</span><span class="p">,</span> <span class="n">learning_offset</span> <span class="o">=</span> <span class="mf">50.</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">lda2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus_tfidf</span><span class="p">)</span>
</code></pre></div>

<p>By using LDA model, we clustered news articles into different groups with specific topics. The following two graphs present the topics generated by LDA with TF-IDF and Bow. Obviously, the TFIDF version is better at finding the core topics. Then we concluded that TFIDF is the appropriate word vector model that fits well in the LDA model. </p>
<p><img alt="LDA-cv.png" src="https://s2.loli.net/2024/03/17/o2l9kgfcZhFTneN.png"></p>
<p><img alt="LDA-tfidf.png" src="https://s2.loli.net/2024/03/17/KA3fFsq6xVGO4Ct.png"></p>
<p>The consistency within groups would make it easier for us to interpret the meaning of features such as sentiment scores of the news articles. The topics are all related to bicoins which are exactly what we are looking for in this project.</p>
<h1>Predictive Modeling</h1>
<p>In our improved logistic model, we used grouped sentiment score, normalized trading volume and the UBL factor(which will be introduced in blog3) as independent variables and the price change as the dependent variables. The code we used is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Logistics regression</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_final1</span><span class="p">[[</span><span class="s1">&#39;polarity_scale_Positive&#39;</span><span class="p">,</span><span class="s1">&#39;polarity_scale_Strongly Negative&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;polarity_scale_Strongly Positive&#39;</span><span class="p">,</span> <span class="s1">&#39;volume_scaled&#39;</span><span class="p">,</span> <span class="s1">&#39;UBL&#39;</span><span class="p">]]</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">df_final1</span><span class="p">[</span><span class="s1">&#39;price_change&#39;</span><span class="p">]</span> 

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict on test data</span>
<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate ROC-AUC score</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC-AUC Score:&quot;</span><span class="p">,</span> <span class="n">roc_auc</span><span class="p">)</span>
</code></pre></div>

<p>The ROC curve is showing as follow:</p>
<p><img alt="ROC.png" src="https://s2.loli.net/2024/03/17/u5AMokFvGcjaL8f.png"></p>
<p>As the AUC score is 0.54, which is bigger than 0.5, our model is effective in predicting the bitcoin price. </p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2024-03-18T01:12:00+08:00">Mon 18 March 2024</time>
            <h4>Category</h4>
            <a class="category-link" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/categories.html#progress-report-ref">Progress Report</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/tags.html#group-gpt-5-ref">Group GPT-5
                    <span class="superscript">3</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/buehlmaier/MFIN7036-student-blog-2024-02" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>