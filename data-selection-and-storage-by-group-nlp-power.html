<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="MFIN7036 Students 2024" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Group NLP Power, Progress Report, " />

<meta property="og:title" content="Data selection and storage (by Group &#34;NLP Power&#34;) "/>
<meta property="og:url" content="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/data-selection-and-storage-by-group-nlp-power.html" />
<meta property="og:description" content="Building Alternative NLP Sentiment Factors - Data Crawling This blog aims to construct an NLP analysis system by extracting the management’s discussion and analysis of financial condition and results of operations from US stock reports. The goal is to derive sentiment evaluations such as optimism, neutrality, and pessimism from the …" />
<meta property="og:site_name" content="MFIN7036 Student Blog 2024" />
<meta property="og:article:author" content="MFIN7036 Students 2024" />
<meta property="og:article:published_time" content="2024-02-24T00:00:00+08:00" />
<meta name="twitter:title" content="Data selection and storage (by Group &#34;NLP Power&#34;) ">
<meta name="twitter:description" content="Building Alternative NLP Sentiment Factors - Data Crawling This blog aims to construct an NLP analysis system by extracting the management’s discussion and analysis of financial condition and results of operations from US stock reports. The goal is to derive sentiment evaluations such as optimism, neutrality, and pessimism from the …">

        <title>Data selection and storage (by Group &#34;NLP Power&#34;)  · MFIN7036 Student Blog 2024
</title>
        <link href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="MFIN7036 Student Blog 2024 - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/"><span class=site-name>MFIN7036 Student Blog 2024</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://buehlmaier.github.io/MFIN7036-student-blog-2024-02
                                    >Home</a>
                                </li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/categories.html">Categories</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/tags.html">Tags</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/data-selection-and-storage-by-group-nlp-power.html">
                Data selection and storage (by Group "NLP Power")
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p><img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/images/NLP-Power_01_image-1.png"></p>
<h2>Building Alternative NLP Sentiment Factors - Data Crawling</h2>
<p>This blog aims to construct an NLP analysis system by extracting the management’s discussion and analysis of financial condition and results of operations from US stock reports. The goal is to derive sentiment evaluations such as optimism, neutrality, and pessimism from the management’s discourse. By combining this with the volatility and price fluctuations of the stock before and after the quarterly report is released, we hope to draw certain conclusions.</p>
<h2>Pre section - Get the constituents of the S&amp;P 500</h2>
<p>Because the crawling process takes too long, we are unable to crawl all the companies on the market. Therefore, we filtered the companies before crawling, and the companies we chose are the constituents of the S&amp;P 500.</p>
<p>We use WRDS to obtain the constituents of the S&amp;P 500. The first problem we encountered is that the same ticker can represent different companies at different points in time due to delisting and changes. Therefore, we use permno to represent different companies. </p>
<p><img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/images/NLP-Power_01_image-2.png"></p>
<p>We have obtained 503 constituents of the S&amp;P 500. The reason for this is that some companies, such as Alphabet, have issued multiple classes of shares.</p>
<p>Next, in order to get the industry classification of S&amp;P 500 companies, we use siccd for division. The industry classification rules of sci are as follows</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Reference: https://www.osha.gov/data/sic-manual</span>
<span class="k">def</span> <span class="nf">sic_to_sector</span><span class="p">(</span><span class="n">sic</span><span class="p">):</span>
    <span class="n">sector</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">sic</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sic2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sic</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Agriculture, Forestry, And Fishing&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Mining&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Construction&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">39</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Manufacturing&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">49</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Transportation, Communications, Electric, Gas, And Sanitary Services&#39;</span> 
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">51</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Wholesale Trade&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">59</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Retail Trade&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">67</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Finance, Insurance, And Real Estate&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">89</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Services&#39;</span>
        <span class="k">elif</span> <span class="n">sic2</span> <span class="o">&lt;=</span> <span class="mi">99</span><span class="p">:</span>
            <span class="n">sector</span> <span class="o">=</span> <span class="s1">&#39;Public Administration&#39;</span>
    <span class="k">return</span> <span class="n">sector</span>
</code></pre></div>

<p>Final result of the S&amp;P 500 companies as follow:</p>
<p><img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/images/NLP-Power_01_image-3.png"></p>
<h3>Step 1. Obtain CIK</h3>
<p>We can obtain each company’s financial reports through <a href="https://www.sec.gov/edgar/searchedgar/companysearch">Edgar</a> (the website of the U.S. Securities and Exchange Commission).First, we need to register our email so that we can obtain data through the official API in the future. Here is the <a href="https://www.sec.gov/developer">website</a> to register your email.</p>
<p>CIK is a unique code for each company, and we can use it to obtain financial reports</p>
<p>import part:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">secedgar</span> <span class="kn">import</span> <span class="n">filings</span><span class="p">,</span> <span class="n">FilingType</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">login_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s2">&quot;Enter your registered email&quot;</span><span class="p">}</span> <span class="c1"># Enter your direct email here. Note that registration is required at https://www.sec.gov/developer</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Retrieve the original data table</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://www.sec.gov/files/company_tickers.json&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">login_info</span><span class="p">)</span>
<span class="c1"># Parse the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="c1"># CIK is a 10-digit number, fill with zeros</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cik_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cik_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

<p>In this code, we are retrieving a JSON file from the SEC website that contains company ticker information. Then parse this data into a pandas DataFrame. The ‘cik_str’ column in the DataFrame contains the CIK (Central Index Key) numbers for the companies, which are unique identifiers assigned by the SEC. We ensure that these CIK numbers are 10 digits long by padding them with zeros on the left if necessary. This is done using the zfill method.</p>
<h3>Step 2. Obtain financial reports through CIK</h3>
<div class="highlight"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]:</span>
    <span class="c1"># Obtain the specific stock&#39;s CIK</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">CIK</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">ticker</span><span class="p">][</span><span class="s1">&#39;cik_str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Retrieve the data</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://data.sec.gov/submissions/CIK</span><span class="si">{</span><span class="n">CIK</span><span class="si">}</span><span class="s1">.json&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">login_info</span><span class="p">)</span>
        <span class="c1"># Convert the data into a DataFrame</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;filings&#39;</span><span class="p">][</span><span class="s1">&#39;recent&#39;</span><span class="p">])</span>
        <span class="c1"># Obtain the quarterly reports (10-Q), can be adjusted according to needs, annual reports are 10-K</span>
        <span class="n">annual_reports</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;10-Q&#39;</span><span class="p">]</span>
        <span class="c1"># Remove the &quot;-&quot; in the &#39;accessionNumber&#39; column</span>
        <span class="n">annual_reports</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;accessionNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annual_reports</span><span class="p">[</span><span class="s1">&#39;accessionNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="c1"># Only keep the necessary columns</span>
        <span class="n">annual_reports</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ticker</span>
        <span class="n">annual_reports</span> <span class="o">=</span> <span class="n">annual_reports</span><span class="p">[[</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span><span class="s1">&#39;accessionNumber&#39;</span><span class="p">,</span><span class="s1">&#39;primaryDocument&#39;</span><span class="p">,</span><span class="s1">&#39;filingDate&#39;</span><span class="p">,</span><span class="s1">&#39;reportDate&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">]]</span>
        <span class="c1"># Construct the link to open the file</span>
        <span class="n">annual_reports</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://www.sec.gov/Archives/edgar/data/&quot;</span> <span class="o">+</span> <span class="n">CIK</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">annual_reports</span><span class="p">[</span><span class="s1">&#39;accessionNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">annual_reports</span><span class="p">[</span><span class="s1">&#39;primaryDocument&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result</span><span class="p">,</span> <span class="n">annual_reports</span><span class="p">])</span>
    <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
    <span class="c1"># Note that the &#39;link&#39; might not be fully displayed, you need to open it in Excel or directly read it through Python.</span>
</code></pre></div>

<p>The rule for the URL of the quarterly reports on the SEC website is as follows:</p>
<p>For example, In https://www.sec.gov/Archives/edgar/data/1507605/000149315223039927/form10-q.htm, </p>
<p>where 1507605 is the CIK with the leading 0 removed</p>
<p>000149315223039927 is the 'accessionNumber' field</p>
<p>form10-q.htm is the 'reportDate' field</p>
<p>In this code, we first retrieve all the reports published by each company through the CIK. Here, the CIK needs to be a 10-digit number.</p>
<div class="highlight"><pre><span></span><code>    <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://data.sec.gov/submissions/CIK</span><span class="si">{</span><span class="n">CIK</span><span class="si">}</span><span class="s1">.json&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">login_info</span><span class="p">)</span>
</code></pre></div>

<p>We then filter out the quarterly reports (10-Q) that we want. If you need other reports, you can replace 10-Q with other fields. For example, 10-K is the annual report.</p>
<div class="highlight"><pre><span></span><code>     <span class="n">annual_reports</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;10-Q&#39;</span><span class="p">]</span>
</code></pre></div>

<p>Finally, in accordance with the rules of the website, we concatenate the URL of the financial report.</p>
<h3>Step 3. Text Extracting</h3>
<p>Now we need to extract the text from the MD&amp;A section of the URL we just obtained in order to prepare for our upcoming text analysis.</p>
<p>We first access the financial report webpage through the URL we previously crawled. Then, we use regular expressions to locate the content of MD&amp;A (Management’s Discussion and Analysis) and Risk Factors. </p>
<p>The core code is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">getMDAndAFromFile</span><span class="p">(</span><span class="n">link_txt</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">cleanText</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link_txt</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">login_info</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">rf</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Item[\s]?5[.|:]?[\s]*?Market.{100,}Item[\s]?7[.|:]?[\s]*?Management[\S]?s[\s]?Discussion[\s]?and[\s]?Analysis.{,50}Operations(.{30,})Item[\s]?7A&#39;</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="o">|</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="c1"># rf = re.search(r&quot;(?is)Item.{0,10}?2.{0,10}?(Management&#39;s\s+Discussion\s+and\s+Analysis[\s\S]*?)(?=Item.{0,10}?3)&quot;, file_content, re.I|re.S)</span>
        <span class="k">if</span> <span class="n">rf</span><span class="p">:</span>
            <span class="n">text_item2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">rf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">text_item2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;None&#39;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span>

<span class="k">def</span> <span class="nf">getRiskFactorFromFile</span><span class="p">(</span><span class="n">link_txt</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>    
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">cleanText</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link_txt</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">login_info</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">rf</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Item[\s]?1[.|:]?[\s]*?Business.{30,}Item[\s]?1A[.|:]?[\s]*?Risk[\s]?Factors(.{30,}?)Item[\s]?1B&#39;</span><span class="p">,</span>
                   <span class="n">file_content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="o">|</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rf</span><span class="p">:</span>
            <span class="n">text_item1a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">rf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">text_item1a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rf</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Item[\s]?1[.|:]?[\s]*?Business.{30,}Item[\s]?1A[.|:]?[\s]*?Risk[\s]?Factors(.{30,}?)Item[\s]?2&#39;</span><span class="p">,</span>
                        <span class="n">file_content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rf</span><span class="p">:</span>
                <span class="n">text_item1a</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s{2,}&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">rf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">text_item1a</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;None&#39;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>We first log into the webpage through the 'link_txt' field, then extract the content we want and make some format adjustments. If we encounter any problems, we return 'None'.</p>
<p>In the end, we can see that the data results we obtained are as follows:</p>
<p><img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/images/NLP-Power_01_image-4.png"></p>
<h2>Thoughts during the process</h2>
<p>When extracting MD&amp;A and risk factors, we encountered several issues. Some companies’ 10-Q reports lack the risk factors section. Ultimately, we substituted 10-K reports for 10-Q, resulting in a significant reduction in our dataset. Regarding company selection, we opted for constituents of the S&amp;P 500 index as of December 31, 2023. Initially, we considered choosing companies from the same industry for better comparability. However, considering data comprehensiveness and varying market capitalizations, we decided to focus on S&amp;P 500 companies, which we believe provides greater representativeness.</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2024-02-24T00:00:00+08:00">Sat 24 February 2024</time>
            <h4>Category</h4>
            <a class="category-link" href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/categories.html#progress-report-ref">Progress Report</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/tags.html#group-nlp-power-ref">Group NLP Power
                    <span class="superscript">4</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/buehlmaier/MFIN7036-student-blog-2024-02" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://buehlmaier.github.io/MFIN7036-student-blog-2024-02/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>